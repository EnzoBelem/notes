#Docker 

[[0. Docker|Sumário]]

## Como funciona a **rede do Docker**

O Docker cria redes virtuais isoladas onde os containers se comunicam entre si por **nomes de serviço** (definidos no `docker-compose.yml`). Por padrão, ele usa uma rede chamada `bridge`, mas com `docker-compose`, redes com nomes próprios (`shared-network`, por exemplo) são mais comuns.

### O DNS interno do Docker

Quando você cria uma rede no Docker Compose (como `shared-network`), o Docker automaticamente provê um **serviço de DNS interno** para resolver os nomes dos containers nessa rede. Ou seja:

- `medclub-hom-api` é um **hostname resolvível** dentro dessa rede
    
- O IP real do container muda entre reinícios, mas o nome `medclub-hom-api` **continua funcionando**
    
- Esse DNS interno é servido pelo IP **`127.0.0.11`** dentro dos containers
    

---

## Detalhe técnico: por que `127.0.0.11`?

O IP `127.0.0.11` é um **loopback interno reservado pelo Docker** para servir como **resolver DNS** para os containers. Ele responde às requisições DNS feitas por `gethostbyname`, `dig`, `nslookup`, etc., dentro do container.

---

## Como identificar/testar o DNS interno do Docker

### Dentro de um container:

Abra um shell interativo em qualquer container que use uma rede Docker (como sua `shared-network`):

```bash
docker exec -it medclub-hom-api sh
```

E execute:

```bash
cat /etc/resolv.conf
```

Você verá algo como:

```
nameserver 127.0.0.11
options ndots:0
```

Isso confirma que o container usa o **resolver interno do Docker**.

---

### Testando a resolução de nomes

Ainda dentro do container, teste:

```bash
ping medclub-dev-api
```

Ou:

```bash
nslookup medclub-dev-api 127.0.0.11
```

Isso mostra que o nome `medclub-dev-api` está sendo resolvido via DNS interno e traduzido para o IP atual do container.

---

## Ver IPs e redes com Docker

Você pode inspecionar redes e containers diretamente:

### Ver redes disponíveis:

```bash
docker network ls
```

Exemplo de saída:

```
NETWORK ID     NAME              DRIVER    SCOPE
e5b1c8d5fb6f   bridge            bridge    local
18f0a5f01cf4   shared-network    bridge    local
```

### Ver detalhes da `shared-network`:

```bash
docker network inspect shared-network
```

Isso retorna um JSON com todos os containers conectados à rede, seus IPs e aliases.
