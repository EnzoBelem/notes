O `debugpy` Ã© o **adaptador oficial de debug para Python** usado pelo VSCode (e por outras ferramentas que implementam o [Debug Adapter Protocol â€“ DAP](https://microsoft.github.io/debug-adapter-protocol/)).

Vamos entender como ele funciona em detalhes:

---

## ğŸ **O que Ã© o `debugpy`**

O `debugpy` Ã© uma biblioteca Python mantida pela Microsoft que **integra o interpretador Python com ferramentas externas de debug**, como o VSCode.

Ele substituiu o antigo `ptvsd` e Ã© hoje a **forma padrÃ£o de fazer debug em Python com o VSCode**, suportando:

- breakpoints (inclusive condicionais)
    
- debug remoto (via TCP)
    
- avaliaÃ§Ã£o de expressÃµes
    
- visualizaÃ§Ã£o de variÃ¡veis
    
- debug de subprocessos
    
- suporte especÃ­fico ao Django, Flask, FastAPI, etc.
    

---

## âš™ï¸ **Como ele funciona internamente**

### ğŸ”Œ 1. **Modo embutido ("listen")**

VocÃª injeta o `debugpy` no processo principal usando:

```bash
python -m debugpy --listen 0.0.0.0:3000 script.py
```

Isso:

- Abre um servidor TCP na porta 3000
    
- Pausa a execuÃ§Ã£o se usado com `--wait-for-client`
    
- Aguarda um cliente (como o VSCode) se conectar e controlar o processo
    

---

### ğŸ” 2. **Modo dinÃ¢mico (injetÃ¡vel)**

VocÃª tambÃ©m pode inserir o debug em tempo de execuÃ§Ã£o:

```python
import debugpy

debugpy.listen(("0.0.0.0", 3000))
debugpy.wait_for_client()  # Pausa atÃ© o VSCode conectar

# Coloque breakpoints no cÃ³digo normalmente
```

Esse modo Ã© Ãºtil para injetar debug em apps jÃ¡ rodando, como Celery ou Gunicorn.

---

## ğŸ“¦ **InstalaÃ§Ã£o**

Geralmente com:

```bash
pip install debugpy
```

Ele nÃ£o tem dependÃªncias pesadas e pode rodar em qualquer ambiente onde o Python funcione.

---

## ğŸ› ï¸ **Recursos suportados**

|Recurso|Suporte|
|---|---|
|Breakpoints|âœ…|
|AvaliaÃ§Ã£o de expressÃµes|âœ…|
|Debug remoto via TCP|âœ…|
|VariÃ¡veis em tempo real|âœ…|
|Debug de threads|âœ…|
|Subprocessos|âœ… (com `"subProcess": true`)|
|Django support (`--django`)|âœ…|
|Multiprocesso (Celery, etc.)|âœ…|

---

## ğŸ“ **Diferencial com Django**

Quando vocÃª usa:

```json
"django": true
```

No `launch.json`, o VSCode ativa alguns comportamentos adicionais:

- reconhece que o `runserver` serÃ¡ usado
    
- evita interferÃªncia de recarregamento automÃ¡tico (`--noreload`)
    
- facilita o debug de middlewares, apps, views e sinais
    

---

## ğŸ§ª **Curiosidade: como o `debugpy` intercepta o Python?**

Internamente, ele usa:

- `sys.settrace()` para interceptar cada linha de execuÃ§Ã£o Python
    
- `threading.settrace()` para pegar novas threads
    
- `signal`, `inspect` e `frame.f_lineno` para navegar pela execuÃ§Ã£o
    

Esses hooks permitem que o `debugpy` pause o cÃ³digo, leia variÃ¡veis, e altere a execuÃ§Ã£o sob demanda.

---

## ğŸ§  **Resumo**

- `debugpy` Ã© a ponte entre o interpretador Python e o VSCode
    
- Ele escuta via socket TCP, aceita comandos, envia eventos
    
- Ã‰ flexÃ­vel: pode ser usado via CLI (`--listen`) ou `import debugpy`
    
- Ã‰ essencial para debug remoto em containers e produÃ§Ã£o controlada
    

---

Se quiser, posso te mostrar como ele se comporta com Celery, Gunicorn, ou atÃ© FastAPI em containers. Quer explorar isso?